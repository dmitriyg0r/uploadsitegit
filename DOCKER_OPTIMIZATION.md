# üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Docker –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. **Multi-stage Docker builds —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º**
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —ç—Ç–∞–ø–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ —Å–±–æ—Ä–∫–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ `node_modules` –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–ª–æ–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `--only=production` –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–∞

### 2. **–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–±—Ä–∞–∑–æ–≤**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `node:18-alpine` (–º–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä)
- –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ npm: `npm cache clean --force`
- –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ª–æ–µ–≤ Docker

### 3. **Healthchecks –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏**
- –î–æ–±–∞–≤–ª–µ–Ω—ã healthcheck'–∏ –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- Backend: `GET /health` endpoint
- Frontend: –ø—Ä–æ–≤–µ—Ä–∫–∞ nginx —á–µ—Ä–µ–∑ curl
- –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤

### 4. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤**
```yaml
# Backend
limits:
  memory: 256M
  cpus: '0.5'
reservations:
  memory: 64M
  cpus: '0.1'

# Frontend  
limits:
  memory: 128M
  cpus: '0.3'
reservations:
  memory: 32M
  cpus: '0.1'
```

### 5. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è nginx**
- –í–∫–ª—é—á–µ–Ω–æ —Å–∂–∞—Ç–∏–µ gzip —Å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (1 –≥–æ–¥)
- –û—Ç–∫–ª—é—á–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏
- –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è proxy –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤

### 6. **BuildKit –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞**
```bash
export DOCKER_BUILDKIT=1
export COMPOSE_DOCKER_CLI_BUILD=1
docker-compose build --parallel
```

### 7. **Dockerignore —Ñ–∞–π–ª—ã**
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ `node_modules`, –ª–æ–≥–æ–≤, –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –£–º–µ–Ω—å—à–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–±–æ—Ä–∫–∏ –≤ 5-10 —Ä–∞–∑
- –ë–æ–ª–µ–µ –±—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤ –≤ Docker daemon

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ (–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ):
- **–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**: 3-5 –º–∏–Ω—É—Ç
- **–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**: 30-60 —Å–µ–∫—É–Ω–¥

### –†–∞–∑–º–µ—Ä—ã –æ–±—Ä–∞–∑–æ–≤:
- **Frontend**: ~50MB (–≤–º–µ—Å—Ç–æ ~200MB)
- **Backend**: ~80MB (–≤–º–µ—Å—Ç–æ ~150MB)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:
- **RAM**: 300MB –æ–±—â–µ–≥–æ (–≤–º–µ—Å—Ç–æ 600MB+)
- **CPU**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –¥–æ 0.8 CPU cores

## üõ† –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

### –ë—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞:
```bash
./quick-rebuild.sh
```

### –†—É—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
```bash
# –í–∫–ª—é—á–µ–Ω–∏–µ BuildKit
export DOCKER_BUILDKIT=1
export COMPOSE_DOCKER_CLI_BUILD=1

# –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞
docker-compose build --parallel

# –ó–∞–ø—É—Å–∫ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
docker-compose up -d
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
curl http://localhost:5001/health
curl http://localhost:8081/nginx-health

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats --no-stream

# –õ–æ–≥–∏
docker-compose logs -f
```

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. **–û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã**
```bash
# –û—á–∏—Å—Ç–∫–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—Ä–∞–∑–æ–≤
docker image prune -f

# –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker container prune -f

# –û—á–∏—Å—Ç–∫–∞ volumes (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
docker volume prune -f
```

### 2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
```bash
# –†–∞–∑–º–µ—Ä—ã –æ–±—Ä–∞–∑–æ–≤
docker images | grep uploadsite

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
docker system df

# –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
docker stats --no-stream --format "table {{.Container}}\t{{.CPUPerc}}\t{{.MemUsage}}"
```

### 3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**
- –ù–∞—Å—Ç—Ä–æ–µ–Ω Watchtower –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- GitHub Actions –¥–ª—è –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è
- Webhook —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è

## üìà –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ:
```bash
# –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ
docker system prune -f

# –ï–∂–µ–º–µ—Å—è—á–Ω–æ  
docker system prune -a -f --volumes
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `./monitor.sh` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏: `docker-compose logs --tail=100`
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞: `df -h`

### –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
1. `docker-compose restart` - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
2. `./quick-rebuild.sh` - –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞
3. `docker system prune -a -f` - –æ—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)

## üéØ –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã

- `Dockerfile` - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞ frontend
- `server/Dockerfile` - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞ backend  
- `docker-compose.yml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
- `nginx.conf` - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π nginx
- `.dockerignore` - –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Å–±–æ—Ä–∫–∏
- `quick-rebuild.sh` - —Å–∫—Ä–∏–ø—Ç –±—ã—Å—Ç—Ä–æ–π –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–í–∞—à–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ç–µ–ø–µ—Ä—å –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ –±–ª–∞–≥–æ–¥–∞—Ä—è:
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–±—Ä–∞–∑–æ–≤  
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ nginx
- Healthcheck'–∞–º –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º —Ä–µ—Å—É—Ä—Å–æ–≤

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `./quick-rebuild.sh` –¥–ª—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤! 